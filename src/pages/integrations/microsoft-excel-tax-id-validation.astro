---
import Layout from '~/layouts/PageLayout.astro';

import Hero2 from '~/components/widgets/Hero2.astro';
import CallToAction from '~/components/widgets/CallToAction.astro';
import Features3 from '~/components/widgets/Features3.astro';
import Content from '~/components/widgets/Content.astro';
import FAQs from '~/components/widgets/FAQs.astro';
import Stats from '~/components/widgets/Stats.astro';

import microsoftExcelAddon from '~/assets/images/taxid-validation-on-excel-sheet.webp';
import bulkValidation from '~/assets/images/bulk-validation.webp';
import globalCommerce from '~/assets/images/bulk-tax-id-validation.webp';
import microsoftExcelEcosystem from '~/assets/images/microsoft-excel-ecosystem.webp';

const metadata = {
  title: 'How to Bulk Validate Tax IDs in Excel (VAT, GST, ABN) | Lookuptax',
  description:
    'Step-by-step guide to validating thousands of VAT, GST, and ABN numbers directly in Microsoft Excel. No macros required. Install the free add-in.',
  keywords:
    'bulk validate vat excel, check gst number in excel, validate abn excel, mass tax id check, excel add-in tax validation',
};

const schema = {
  '@context': 'https://schema.org',
  '@graph': [
    {
      '@type': 'SoftwareApplication',
      name: 'Lookuptax Excel Add-in',
      applicationCategory: 'BusinessApplication',
      operatingSystem: 'Windows, macOS',
      offers: {
        '@type': 'Offer',
        price: '0',
        priceCurrency: 'USD',
      },
    },
    {
      '@type': 'HowTo',
      name: 'How to Bulk Validate Tax IDs in Excel',
      step: [
        {
          '@type': 'HowToStep',
          name: 'Install the Add-in',
          text: 'Get the Lookuptax add-in from the Microsoft AppSource.',
        },
        {
          '@type': 'HowToStep',
          name: 'Select Data Range',
          text: 'Choose the columns with tax IDs and country codes you want to validate.',
        },
        {
          '@type': 'HowToStep',
          name: 'Run Validation',
          text: 'Tax IDs are validated in bulk, with results appearing in a new column.',
        },
      ],
    },
    {
      '@type': 'FAQPage',
      mainEntity: [
        {
          '@type': 'Question',
          name: 'Can I validate EU VIES VAT numbers in Excel?',
          acceptedAnswer: {
            '@type': 'Answer',
            text: 'Yes! We connect directly to the EU VIES database. You can validate VAT numbers from all 27 member states + Northern Ireland instantly.',
          },
        },
        {
          '@type': 'Question',
          name: 'Do I need to enable Macros?',
          acceptedAnswer: {
            '@type': 'Answer',
            text: 'No. Lookuptax is a modern Office Add-in. It runs securely without requiring you to enable dangerous VBA Macros or scripts.',
          },
        },
        {
          '@type': 'Question',
          name: 'How many rows can I check at once?',
          acceptedAnswer: {
            '@type': 'Answer',
            text: 'You can typically process batches of 1,000+ rows quickly. For larger lists over 100k, we recommend using our API directly.',
          },
        },
        {
          '@type': 'Question',
          name: 'Is it free to use in Excel?',
          acceptedAnswer: {
            '@type': 'Answer',
            text: 'The add-in is free to install. You get 100 free validation credits to start, with affordable packs for higher volumes.',
          },
        },
      ],
    },
  ],
};
---

<Layout metadata={metadata}>
  <script type="application/ld+json" set:html={JSON.stringify(schema)} />
  <!-- Hero2 Widget ******************* -->

  <Hero2
    tagline="Excel Integration Guide"
    title="How to Bulk Validate Tax IDs Directly in Excel"
    subtitle="Stop manually copying numbers to government websites. Use the automated Lookuptax Add-in to check 1,000+ VAT, GST, and ABN numbers instantly inside your spreadsheet."
    actions={[
      {
        variant: 'primary',
        text: 'Get Excel Add-in Free',
        href: 'https://platform.lookuptax.com/auth?page=register',
        icon: 'tabler:download',
      },
      { text: 'See How it Works', href: '#how-it-works' },
    ]}
    image={{
      src: microsoftExcelAddon,
      alt: 'Screenshot showing bulk validation of tax IDs in Excel',
    }}
  />

  <!-- Features3 Widget ************** -->

  <Features3
    id="how-it-works"
    title="3 Simple Steps to Validate Tax IDs"
    subtitle="You don't need complex VBA scripts or macros. Here is the easiest way to clean your tax data:"
    tagline="Tutorial"
    columns={2}
    items={[
      {
        title: 'Step 1: Install the Add-in',
        description: `Open Excel, go to "Get Add-ins", search for 'Lookuptax', and click 'Add'. It connects directly to our official validation engine.`,
        icon: 'tabler:number-1',
      },
      {
        title: 'Step 2: Highlight Your Data',
        description:
          'Select the column containing your VAT, GST, or Tax IDs. The add-in automatically detects the country code.',
        icon: 'tabler:number-2',
      },
      {
        title: 'Step 3: Click "Validate"',
        description:
          'Watch as we ping official government databases in real-time. Statuses and company names appear instantly in the next column.',
        icon: 'tabler:number-3',
      },
      {
        title: 'Step 4: Export Clean Data',
        description: `Your sheet is now audit-ready. Save it or export it to CSV. Invalid IDs are highlighted for review.`,
        icon: 'tabler:number-4',
      },
    ]}
    image={{
      src: bulkValidation,
      alt: 'Visual guide showing the 3 steps to validate in Excel',
    }}
  />

  <!-- Content Widget **************** -->

  <Content
    isReversed
    title="Why Use an Excel Add-in vs. Manual Checks?"
    items={[
      {
        title: 'Save Hours of Data Entry',
        description:
          'Manually checking 500 VAT numbers takes ~4 hours. With Lookuptax for Excel, it takes < 2 minutes.',
        icon: 'tabler:clock',
      },
      {
        title: '100% Accuracy (No Copy-Paste Errors)',
        description:
          'Eliminate human error. We verify directly against official sources like VIES (EU), HMRC (UK), and GST Portal (India).',
        icon: 'tabler:target',
      },
      {
        title: 'Data Enrichment included',
        description:
          'We don’t just say "Valid". We return the registered Business Name and Address whenever available from the official source.',
        icon: 'tabler:table-export',
      },
    ]}
    image={{
      src: globalCommerce,
      alt: 'Comparison of manual vs automated validation',
    }}
  />

  <!-- Content Widget **************** -->

  <Content
    isAfterContent
    title="Advanced Features for Power Users"
    items={[
      {
        title: 'No Macros Required',
        description:
          'Secure and IT-approved. Our modern add-in doesn’t use risky VBA macros that get blocked by firewalls.',
        icon: 'tabler:shield-check',
      },
      {
        title: 'Handles 100+ Countries',
        description:
          'Mix and match countries in the same sheet. We smart-route each ID to the correct government database.',
        icon: 'tabler:world',
      },
      {
        title: 'Auto-Formatting',
        description: 'Our tool automatically strips special characters and fixes formatting errors before validation.',
        icon: 'tabler:wand',
      },
    ]}
    image={{
      src: microsoftExcelEcosystem,
      alt: 'Advanced Excel features',
    }}
  />

  <!-- Stats Widget ****************** -->

  <Stats
    title="Trusted by Finance Teams globally"
    stats={[
      { amount: '5M+', title: 'IDs Validated' },
      { amount: '100+', title: 'Supported Countries' },
      { amount: '0', title: 'Macros Used' },
      { amount: '100%', title: 'Secure' },
    ]}
  />

  <!-- FAQs Widget ******************* -->

  <FAQs
    title="Common Questions about Excel Validation"
    items={[
      {
        title: 'Can I validate EU VIES VAT numbers in Excel?',
        description:
          'Yes! We connect directly to the EU VIES database. You can validate VAT numbers from all 27 member states + Northern Ireland instantly.',
      },
      {
        title: 'Do I need to enable Macros?',
        description:
          'No. Lookuptax is a modern Office Add-in. It runs securely without requiring you to enable dangerous VBA Macros or scripts.',
      },
      {
        title: 'How many rows can I check at once?',
        description: `Our add-in is optimized for performance. You can typically process batches of 1,000+ rows quickly. For lists over 100k, we recommend our API.`,
      },
      {
        title: 'Is it free to use in Excel?',
        description:
          'The add-in is free to install. You get 100 free validation credits to start, with affordable packs for higher volumes.',
      },
    ]}
  />

  <!-- CallToAction Widget *********** -->

  <CallToAction
    id="download"
    title="Stop Checking Tax IDs Manually"
    subtitle="Install the Lookuptax Add-in for Excel now and clean your customer data in minutes."
    actions={[
      {
        variant: 'primary',
        text: 'Get It on AppSource',
        href: 'https://platform.lookuptax.com/auth?page=register',
        icon: 'tabler:download',
      },
    ]}
  />
</Layout>
