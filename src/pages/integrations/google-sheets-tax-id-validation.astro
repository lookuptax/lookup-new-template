---
import Layout from '~/layouts/PageLayout.astro';

import Hero2 from '~/components/widgets/Hero2.astro';
import CallToAction from '~/components/widgets/CallToAction.astro';
import Features3 from '~/components/widgets/Features3.astro';
import Content from '~/components/widgets/Content.astro';
import FAQs from '~/components/widgets/FAQs.astro';
import Stats from '~/components/widgets/Stats.astro';

import googleSheetAddon from '~/assets/images/tax-id-validation-google-sheet.webp';
import bulkValidation from '~/assets/images/bulk-validation.webp';
import globalCommerce from '~/assets/images/tax-id-addon-google-sheet.webp';
import googleSheetEcosystem from '~/assets/images/google-sheet-ecosystem.webp';

const metadata = {
  title: 'How to Bulk Validate Tax IDs in Google Sheets (VAT, GST, ABN)',
  description:
    'Step-by-step guide to validating tax IDs, VAT numbers, and GSTINs directly in Google Sheets. Install our free add-on to check thousands of rows instantly.',
  keywords:
    'google sheets tax id validation, bulk check vat google sheets, validate gst google sheets, abn lookup google sheets, tax compliance add-on',
};

const schema = {
  '@context': 'https://schema.org',
  '@graph': [
    {
      '@type': 'SoftwareApplication',
      name: 'Lookuptax Google Sheets Add-on',
      applicationCategory: 'BusinessApplication',
      operatingSystem: 'Browser',
      offers: {
        '@type': 'Offer',
        price: '0',
        priceCurrency: 'USD',
      },
    },
    {
      '@type': 'HowTo',
      name: 'How to Bulk Validate Tax IDs in Google Sheets',
      step: [
        {
          '@type': 'HowToStep',
          name: 'Get the Add-on',
          text: "Install 'Lookuptax' from the Google Workspace Marketplace.",
        },
        {
          '@type': 'HowToStep',
          name: 'Select Your Columns',
          text: 'Highlight the cells containing your customer Tax IDs.',
        },
        {
          '@type': 'HowToStep',
          name: 'Run Bulk Check',
          text: "Click 'Start Validation' to ping official databases.",
        },
      ],
    },
    {
      '@type': 'FAQPage',
      mainEntity: [
        {
          '@type': 'Question',
          name: 'Does this work on Mac and Windows?',
          acceptedAnswer: {
            '@type': 'Answer',
            text: 'Yes! Because it works in the browser (Google Sheets), it runs perfectly on Mac, Windows, Linux, and Chromebooks.',
          },
        },
        {
          '@type': 'Question',
          name: 'Can I validate EU VIES VAT numbers?',
          acceptedAnswer: {
            '@type': 'Answer',
            text: 'Absolutely. We provide a direct connection to the EU VIES system for real-time validity checks of all EU VAT numbers.',
          },
        },
        {
          '@type': 'Question',
          name: 'Is my data secure inside Google Sheets?',
          acceptedAnswer: {
            '@type': 'Answer',
            text: 'Yes. The add-on runs with strict permissions. We only process the cells you explicitly select for validation.',
          },
        },
        {
          '@type': 'Question',
          name: 'Is there a free tier?',
          acceptedAnswer: {
            '@type': 'Answer',
            text: 'Yes. Install the add-on for free and get 100 validation credits to test the service with your own data.',
          },
        },
      ],
    },
  ],
};
---

<Layout metadata={metadata}>
  <script type="application/ld+json" set:html={JSON.stringify(schema)} />
  <!-- Hero2 Widget ******************* -->

  <Hero2
    tagline="Google Sheets Guide"
    title="How to Bulk Validate Tax IDs in Google Sheets"
    subtitle="Turn your spreadsheet into a powerful compliance tool. Check validity, format, and registered business names for thousands of Tax IDs instantly."
    actions={[
      {
        variant: 'primary',
        text: 'Install Free Add-on',
        href: 'https://platform.lookuptax.com/auth?page=register',
        icon: 'tabler:download',
      },
      { text: 'See Tutorial', href: '#how-it-works' },
    ]}
    image={{
      src: googleSheetAddon,
      alt: 'Screenshot of Lookuptax add-on validating IDs in Google Sheets',
    }}
  />

  <!-- Features3 Widget ************** -->

  <Features3
    id="how-it-works"
    title="Start Validating in 3 Steps"
    subtitle="No need for complex API scripts or manual copy-pasting. Just install and run."
    tagline="Tutorial"
    columns={2}
    items={[
      {
        title: 'Step 1: Get the Add-on',
        description: `Install 'Lookuptax' from the Google Workspace Marketplace. It integrates securely with your Sheets environment.`,
        icon: 'tabler:number-1',
      },
      {
        title: 'Step 2: Select Your Columns',
        description:
          'Highlight the cells containing your customer Tax IDs. Our smart-detect algorithm identifies the country automatically.',
        icon: 'tabler:number-2',
      },
      {
        title: 'Step 3: Run Bulk Check',
        description:
          'Click "Start Validation". We ping official databases (VIES, HMRC, ABR) and return live status codes.',
        icon: 'tabler:number-3',
      },
      {
        title: 'Step 4: Collaborate & Export',
        description: `Share the results with your finance team directly in the sheet or export as a clean CSV/PDF report.`,
        icon: 'tabler:number-4',
      },
    ]}
    image={{
      src: bulkValidation,
      alt: 'Visual guide: bulk tax validation flow in Google Sheets',
    }}
  />

  <!-- Content Widget **************** -->

  <Content
    isReversed
    title="Why Google Sheets + Lookuptax?"
    items={[
      {
        title: 'Real-Time Collaboration',
        description:
          'Your whole finance team can work on the same validation sheet simultaneously. No emailing files back and forth.',
        icon: 'tabler:users',
      },
      {
        title: 'Live Official Data',
        description: 'We connect your sheet to official government databases. No stale or cached data ever.',
        icon: 'tabler:database',
      },
      {
        title: 'Privacy-First Architecture',
        description:
          'We are GDPR compliant. Your customer data is encrypted and never stored longer than necessary for processing.',
        icon: 'tabler:shield-lock',
      },
    ]}
    image={{
      src: globalCommerce,
      alt: 'Team collaborating on tax validation',
    }}
  />

  <!-- Content Widget **************** -->

  <Content
    isAfterContent
    title="Advanced Features for Power Users"
    items={[
      {
        title: 'Custom Formulas',
        description: 'Use our custom =VALIDATE_TAX() formulas (coming soon) for dynamic cell-based checking.',
        icon: 'tabler:math-function',
      },
      {
        title: 'Handles 100+ Countries',
        description: 'Validate EU VAT, Indian GST, Australian ABN, and US EINs all in the same column.',
        icon: 'tabler:world',
      },
      {
        title: 'Apps Script Compatible',
        description: 'Developers can use our library in Google Apps Script for custom automation workflows.',
        icon: 'tabler:code',
      },
    ]}
    image={{
      src: googleSheetEcosystem,
      alt: 'Google Sheets advanced ecosystem',
    }}
  />

  <!-- Stats Widget ****************** -->

  <Stats
    title="Trusted by 10,000+ Finance Pros"
    stats={[
      { amount: '5M+', title: 'IDs Checked' },
      { amount: '100+', title: 'Countries' },
      { amount: '0', title: 'Data Breaches' },
      { amount: '5.0', title: 'Rating' },
    ]}
  />

  <!-- FAQs Widget ******************* -->

  <FAQs
    title="Common Questions"
    items={[
      {
        title: 'Does this work on Mac and Windows?',
        description:
          'Yes! Because it works in the browser (Google Sheets), it runs perfectly on Mac, Windows, Linux, and Chromebooks.',
      },
      {
        title: 'Can I validate EU VIES VAT numbers?',
        description:
          'Absolutely. We provide a direct connection to the EU VIES system for real-time validity checks of all EU VAT numbers.',
      },
      {
        title: 'Is my data secure inside Google Sheets?',
        description: `Yes. The add-on runs with strict permissions. We only process the cells you explicitly select for validation.`,
      },
      {
        title: 'Is there a free tier?',
        description:
          'Yes. Install the add-on for free and get 100 validation credits to test the service with your own data.',
      },
    ]}
  />

  <!-- CallToAction Widget *********** -->

  <CallToAction
    id="download"
    title="Automate Tax Compliance in Sheets"
    subtitle="Stop manual checks. Install Lookuptax for Google Sheets and clean your customer database today."
    actions={[
      {
        variant: 'primary',
        text: 'Install Free Add-on',
        href: 'https://platform.lookuptax.com/auth?page=register',
        icon: 'tabler:brand-google',
      },
    ]}
  />
</Layout>
